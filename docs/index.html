<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script type="text/javascript"
    src="https://cdn.jsdelivr.net/npm/brython@3.9.0/brython.min.js"></script>
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Noughts and Crosses</title>
    <link rel="stylesheet" href="style.css">
</head>
<body onload="brython()">
    <section>
        <h1 class="heading">Noughts and Crosses</h1>
        <div class="game--container">
            <span id="C0" class="cell"></span>
            <span id="C1" class="cell"></span>
            <span id="C2" class="cell"></span>
            <span id="C3" class="cell"></span>
            <span id="C4" class="cell"></span>
            <span id="C5" class="cell"></span>
            <span id="C6" class="cell"></span>
            <span id="C7" class="cell"></span>
            <span id="C8" class="cell"></span>
        </div>
        <h2 id="game-status" class="game-status"></h2>
        <button id="btnNewGame" class="new-game">Start new game</button>
    </section>
<script type="text/python">

from browser import document, window, alert

global currPlayer
global nextPlayer
global winningPlays

currPlayer = "X"
nextPlayer = "O"

gameStatus = 0

winningPlays = [
    [0, 1, 2],
    [3, 4, 5],
    [6, 7, 8],
    [0, 3, 6],
    [1, 4, 7],
    [2, 5, 8],
    [0, 4, 8],
    [2, 4, 6]
]


def marker_cell0(event):
    document["C0"].textContent = currPlayer
    playGame()
    document["C0"].unbind("click", marker_cell0)

def marker_cell1(event):
    document["C1"].textContent = currPlayer
    playGame()
    document["C1"].unbind("click", marker_cell1)

def marker_cell2(event):
    document["C2"].textContent = currPlayer
    playGame()
    document["C2"].unbind("click", marker_cell2)

def marker_cell3(event):
    document["C3"].textContent = currPlayer
    changePlayer(currPlayer, nextPlayer)
    document["C3"].unbind("click", marker_cell3)

def marker_cell4(event):
    document["C4"].textContent = currPlayer
    playGame()
    document["C4"].unbind("click", marker_cell4)

def marker_cell5(event):
    document["C5"].textContent = currPlayer
    playGame()
    document["C5"].unbind("click", marker_cell5)

def marker_cell6(event):
    document["C6"].textContent = currPlayer
    playGame()
    document["C6"].unbind("click", marker_cell6)

def marker_cell7(event):
    document["C7"].textContent = currPlayer
    playGame()
    document["C7"].unbind("click", marker_cell7)

def marker_cell8(event):
    document["C8"].textContent = currPlayer
    playGame()
    document["C8"].unbind("click", marker_cell8)

def getBoard():
    board = [
        document["C0"].textContent,
        document["C1"].textContent,
        document["C2"].textContent,
        document["C3"].textContent,
        document["C4"].textContent,
        document["C5"].textContent,
        document["C6"].textContent,
        document["C7"].textContent,
        document["C8"].textContent
    ]
    return board

def getValueBoard(board):
    lt = []
    for i in board:
        if i=="X":
            lt.append(1)
        elif i=="O":
            lt.append(2)
        else:
            lt.append(0)
    valBoard = [str(x) for x in lt]
    valBoard = ''.join(valBoard)
    return valBoard

def checkWinner(board, winningCombos):
    Xwin = ["X", "X", "X"]
    Owin = ["O", "O", "O"]
    for combination in winningCombos:
        checkWin = [board[i] for i in combination]
        if checkWin==Xwin:
            winner = "X"
            break
        elif checkWin==Owin:
            winner = "O"
            break
        else:
            winner = 0
    return winner

def changePlayer(current, next):
    global currPlayer
    global nextPlayer

    temp = current
    current = next
    next = temp

    currPlayer = current
    nextPlayer = next

def unbindAll():
    document["C0"].unbind("click", marker_cell0)
    document["C1"].unbind("click", marker_cell1)
    document["C2"].unbind("click", marker_cell2)
    document["C3"].unbind("click", marker_cell3)
    document["C4"].unbind("click", marker_cell4)
    document["C5"].unbind("click", marker_cell5)
    document["C6"].unbind("click", marker_cell6)
    document["C7"].unbind("click", marker_cell7)
    document["C8"].unbind("click", marker_cell8)

def newGame(event):
    global currPlayer
    global nextPlayer

    currPlayer = "X"
    nextPlayer = "O"
    document["C0"].textContent = ""
    document["C1"].textContent = ""
    document["C2"].textContent = ""
    document["C3"].textContent = ""
    document["C4"].textContent = ""
    document["C5"].textContent = ""
    document["C6"].textContent = ""
    document["C7"].textContent = ""
    document["C8"].textContent = ""
    document["game-status"].textContent = ""
    bindAll()

def playGame():
    board = getBoard()
    winner = checkWinner(board, winningPlays)
    if winner!=0:
        unbindAll()
        msg = "Player %s wins!" % winner
        document["game-status"].textContent = msg

    changePlayer(currPlayer, nextPlayer)

def bindAll():
    document["C0"].bind("click", marker_cell0)
    document["C1"].bind("click", marker_cell1)
    document["C2"].bind("click", marker_cell2)
    document["C3"].bind("click", marker_cell3)
    document["C4"].bind("click", marker_cell4)
    document["C5"].bind("click", marker_cell5)
    document["C6"].bind("click", marker_cell6)
    document["C7"].bind("click", marker_cell7)
    document["C8"].bind("click", marker_cell8)


bindAll()
document["btnNewGame"].bind("click", newGame)

</script>
</body>
</html>
